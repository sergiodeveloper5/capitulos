<?xml version="1.0" encoding="utf-8"?>
<!--
    ARCHIVO: capitulo_wizard_view.xml
    PROPSITO: Definici贸n de vistas para el wizard de gesti贸n de cap铆tulos t茅cnicos
    
    FUNCIONALIDAD PRINCIPAL:
    - Interfaz de usuario para crear y gestionar cap铆tulos t茅cnicos en presupuestos
    - Soporte para dos modos: usar cap铆tulos existentes o crear nuevos
    - Gesti贸n visual de secciones con productos y configuraciones
    - Interfaz intuitiva con toggles, handles y formularios embebidos
    
    COMPONENTES PRINCIPALES:
    1. Vista formulario del wizard (capitulo_wizard_form_view)
    2. Acci贸n para abrir el wizard (capitulo_wizard_action)
    
    CARACTERSTICAS DE UX:
    - Dise帽o responsivo con alertas informativas
    - Campos condicionales seg煤n el modo seleccionado
    - Interfaz drag-and-drop para reordenar elementos
    - Botones de acci贸n claramente diferenciados
    - Validaciones visuales y ayudas contextuales
    
    INTEGRACIN:
    - Se abre desde el formulario de pedidos de venta
    - Interact煤a con modelos: capitulo.wizard, capitulo.wizard.seccion, capitulo.wizard.line
    - Retorna al presupuesto despu茅s de completar las acciones
    
    TECNOLOGAS UTILIZADAS:
    - Widgets especializados: radio, boolean_toggle, handle
    - Bootstrap classes para alertas y estilos
    - Notebooks para organizaci贸n por pesta帽as
    - Formularios embebidos para edici贸n detallada
-->
<odoo>
    <!-- 
        VISTA PRINCIPAL DEL WIZARD DE CAPTULOS
        =====================================
        
        PROPSITO:
        - Interfaz principal para gestionar cap铆tulos t茅cnicos en presupuestos
        - Permite crear nuevos cap铆tulos o usar existentes
        - Gesti贸n completa de secciones y productos
        
        ESTRUCTURA:
        1. Selector de modo (existente/nuevo)
        2. Campos espec铆ficos por modo
        3. Gesti贸n de secciones y productos
        4. Condiciones particulares
        5. Botones de acci贸n
        
        CARACTERSTICAS UX:
        - Alertas informativas para guiar al usuario
        - Campos condicionales que se muestran seg煤n el contexto
        - Interfaz visual con iconos y colores distintivos
        - Validaciones en tiempo real
    -->
    <record id="capitulo_wizard_form_view" model="ir.ui.view">
        <field name="name">capitulo.wizard.form</field>
        <field name="model">capitulo.wizard</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <!-- 
                        ALERTA INFORMATIVA PRINCIPAL
                        ===========================
                        Proporciona contexto inmediato sobre la funcionalidad del wizard
                    -->
                    <div class="alert alert-info" role="alert">
                        <strong>Gesti贸n de Cap铆tulos:</strong> Puede usar un cap铆tulo existente o crear uno nuevo desde cero.
                    </div>
                    
                    <!-- 
                        SELECTOR DE MODO DE OPERACIN
                        ============================
                        Widget radio horizontal para selecci贸n clara entre modos:
                        - 'existente': Usar un cap铆tulo ya creado
                        - 'nuevo': Crear un cap铆tulo desde cero
                    -->
                    <group>
                        <field name="modo_creacion" widget="radio" options="{'horizontal': true}"/>
                    </group>
                    
                    <!-- 
                        SECCIN: CAPTULO EXISTENTE
                        ==========================
                        Campos visibles solo cuando modo_creacion == 'existente'
                        
                        CARACTERSTICAS:
                        - Campo de selecci贸n con opciones restringidas (no_create, no_edit)
                        - Placeholder descriptivo para guiar la selecci贸n
                        - Help text explicativo
                        - Validaci贸n requerida condicional
                    -->
                    <group invisible="modo_creacion != 'existente'">
                        <field name="capitulo_id" options="{'no_create': True, 'no_edit': True}" 
                               placeholder="Seleccione un cap铆tulo existente..." 
                               help="Seleccione un cap铆tulo ya creado para aplicar al presupuesto"
                               required="modo_creacion == 'existente'"/>
                    </group>
                    
                    <!-- 
                        SECCIN: NUEVO CAPTULO
                        =======================
                        Campos visibles solo cuando modo_creacion == 'nuevo'
                        
                        CAMPOS:
                        - nuevo_capitulo_nombre: Nombre requerido del cap铆tulo
                        - nuevo_capitulo_descripcion: Descripci贸n opcional
                        
                        CARACTERSTICAS:
                        - Placeholders descriptivos
                        - Help text explicativo
                        - Validaci贸n requerida condicional
                    -->
                    <group invisible="modo_creacion != 'nuevo'">
                        <field name="nuevo_capitulo_nombre" placeholder="Nombre del nuevo cap铆tulo..." 
                               help="Especifique el nombre para el nuevo cap铆tulo"
                               required="modo_creacion == 'nuevo'"/>
                        <field name="nuevo_capitulo_descripcion" placeholder="Descripci贸n del cap铆tulo..."/>
                    </group>
                    
                    <!-- 
                        NOTEBOOK: ORGANIZACIN POR PESTAAS
                        ==================================
                        Divide la funcionalidad en secciones l贸gicas:
                        1. Secciones y Productos (pesta帽a principal)
                        2. Condiciones Particulares (pesta帽a secundaria)
                    -->
                    <notebook>
                        <!-- 
                            PESTAA: SECCIONES Y PRODUCTOS
                            ==============================
                            Pesta帽a principal con toda la gesti贸n de contenido del cap铆tulo
                        -->
                        <page string="Secciones y Productos">
                            <!-- 
                                TTULO DINMICO DEL CAPTULO EXISTENTE
                                =====================================
                                Muestra prominentemente el nombre del cap铆tulo seleccionado
                                
                                CARACTERSTICAS:
                                - Visible solo en modo 'existente' con cap铆tulo seleccionado
                                - Estilo destacado con Bootstrap alert-primary
                                - Icono  para identificaci贸n visual
                                - Campo readonly embebido para mostrar el nombre
                            -->
                            <div invisible="modo_creacion != 'existente' or not capitulo_id" class="alert alert-primary" role="alert" style="margin-bottom: 15px; text-align: center; font-size: 18px; border: 2px solid #007bff;">
                                <strong> CAPTULO: </strong><field name="capitulo_id" readonly="1" nolabel="1" style="display: inline; font-weight: bold; font-size: 20px; color: #007bff;"/>
                            </div>
                            
                            <!-- 
                                TTULO DINMICO DEL NUEVO CAPTULO
                                =================================
                                Muestra prominentemente el nombre del nuevo cap铆tulo
                                
                                CARACTERSTICAS:
                                - Visible solo en modo 'nuevo' con nombre especificado
                                - Estilo destacado con Bootstrap alert-primary
                                - Icono  para identificaci贸n visual
                                - Campo readonly embebido para mostrar el nombre
                            -->
                            <div invisible="modo_creacion != 'nuevo' or not nuevo_capitulo_nombre" class="alert alert-primary" role="alert" style="margin-bottom: 15px; text-align: center; font-size: 18px; border: 2px solid #007bff;">
                                <strong> NUEVO CAPTULO: </strong><field name="nuevo_capitulo_nombre" readonly="1" nolabel="1" style="display: inline; font-weight: bold; font-size: 20px; color: #007bff;"/>
                            </div>
                            
                            <!-- 
                                INSTRUCCIONES DE USO
                                ===================
                                Gu铆a paso a paso para el usuario
                                
                                PASOS:
                                1. Marcar secciones a incluir
                                2. A帽adir productos a cada secci贸n
                                3. Ejecutar la acci贸n de a帽adir al presupuesto
                            -->
                            <div class="alert alert-info" role="alert" style="margin-bottom: 15px;">
                                <strong> Instrucciones:</strong><br/>
                                <strong>1.</strong> Marque las secciones que desea incluir<br/>
                                <strong>2.</strong> A帽ada productos a cada secci贸n marcada<br/>
                                <strong>3.</strong> Haga clic en "A帽adir al Presupuesto"
                            </div>
                            
                            <!-- 
                                GESTIN DE SECCIONES
                                ===================
                                Campo One2many para gestionar las secciones del cap铆tulo
                                
                                VISTA LISTA:
                                - Handle para reordenamiento drag-and-drop
                                - Nombre de secci贸n con estilo destacado
                                - Toggle para incluir/excluir secci贸n
                                - Indicador de secci贸n fija (readonly)
                                - Opciones: create, delete habilitados; edit deshabilitado
                                
                                VISTA FORMULARIO EMBEBIDA:
                                - Formulario completo para edici贸n detallada de secciones
                                - Gesti贸n de productos dentro de cada secci贸n
                            -->
                            <field name="seccion_ids">
                                <!-- 
                                    VISTA LISTA DE SECCIONES
                                    =======================
                                    Interfaz compacta para gesti贸n r谩pida de secciones
                                -->
                                <list create="true" delete="true" edit="false">
                                    <!-- Handle para reordenamiento visual -->
                                    <field name="sequence" widget="handle"/>
                                    <!-- Nombre con estilo destacado -->
                                    <field name="name" string="Secci贸n" decoration-bf="1" style="font-weight: bold; font-size: 14px;"/>
                                    <!-- Toggle para inclusi贸n en presupuesto -->
                                    <field name="incluir" string="Incluir" widget="boolean_toggle"/>
                                    <!-- Indicador de secci贸n fija (no editable) -->
                                    <field name="es_fija" string="Fija" widget="boolean_toggle" readonly="1"/>
                                </list>
                                
                                <!-- 
                                    FORMULARIO EMBEBIDO DE SECCIN
                                    =============================
                                    Interfaz completa para edici贸n detallada de cada secci贸n
                                -->
                                <form>
                                    <sheet>
                                        <!-- 
                                            TTULO DE LA SECCIN
                                            ===================
                                            Campo principal con estilo destacado
                                        -->
                                        <div class="oe_title">
                                            <h1>
                                                <field name="name" placeholder="Nombre de la secci贸n..." required="1" style="font-size: 18px; font-weight: bold;"/>
                                            </h1>
                                        </div>
                                        
                                        <!-- 
                                            CONFIGURACIN DE LA SECCIN
                                            ==========================
                                            Campos de configuraci贸n organizados en grupos
                                        -->
                                        <group>
                                            <group>
                                                <!-- Toggle para incluir en presupuesto -->
                                                <field name="incluir" string="Incluir en Presupuesto" widget="boolean_toggle"/>
                                                <!-- Secuencia para ordenamiento -->
                                                <field name="sequence"/>
                                                <!-- Categor铆a de productos para filtrado -->
                                                <field name="product_category_id" string="Categor铆a de Productos" 
                                                       help="Selecciona una categor铆a para filtrar los productos disponibles"/>
                                            </group>
                                            <group>
                                                <!-- Indicador de secci贸n fija (readonly) -->
                                                <field name="es_fija" readonly="1"/>
                                            </group>
                                        </group>
                                        
                                        <!-- 
                                            NOTEBOOK DE SECCIN
                                            ==================
                                            Organizaci贸n por pesta帽as del contenido de la secci贸n
                                        -->
                                        <notebook>
                                            <!-- 
                                                PESTAA: PRODUCTOS
                                                =================
                                                Gesti贸n de productos dentro de la secci贸n
                                            -->
                                            <page string="Productos">
                                                <!-- 
                                                    LISTA EDITABLE DE PRODUCTOS
                                                    ==========================
                                                    Interfaz para gestionar productos de la secci贸n
                                                    
                                                    CARACTERSTICAS:
                                                    - Edici贸n inline (editable="bottom")
                                                    - Handle para reordenamiento
                                                    - Campos principales: producto, descripci贸n, cantidad, precio
                                                    - Toggles para inclusi贸n y marcado como opcional
                                                    - Suma autom谩tica de cantidades
                                                -->
                                                <field name="line_ids">
                                                    <list editable="bottom">
                                                        <!-- Handle para reordenamiento -->
                                                        <field name="sequence" widget="handle"/>
                                                        <!-- Selecci贸n de producto (requerido) -->
                                                        <field name="product_id" string="Producto" required="1"/>
                                                        <!-- Descripci贸n personalizable -->
                                                        <field name="descripcion_personalizada" string="Descripci贸n"/>
                                                        <!-- Cantidad con suma autom谩tica -->
                                                        <field name="cantidad" string="Cantidad" sum="Total"/>
                                                        <!-- Precio unitario -->
                                                        <field name="precio_unitario" string="Precio Unitario"/>
                                                        <!-- Toggle para incluir producto -->
                                                        <field name="incluir" string="Incluir" widget="boolean_toggle"/>
                                                        <!-- Toggle para marcar como opcional -->
                                                        <field name="es_opcional" string="Opcional" widget="boolean_toggle"/>
                                                    </list>
                                                </field>
                                            </page>
                                        </notebook>
                                    </sheet>
                                </form>
                            </field>
                        </page>
                        
                        <!-- 
                            PESTAA: CONDICIONES PARTICULARES
                            ================================
                            rea de texto para especificar condiciones especiales del presupuesto
                            
                            CARACTERSTICAS:
                            - Campo de texto largo
                            - Placeholder descriptivo
                            - Contenido opcional
                        -->
                        <page string="Condiciones Particulares">
                            <field name="condiciones_particulares" placeholder="Escriba aqu铆 las condiciones particulares para este presupuesto..."/>
                        </page>
                    </notebook>
                </sheet>
                
                <!-- 
                    FOOTER: BOTONES DE ACCIN
                    ========================
                    Conjunto de botones para las acciones principales del wizard
                    
                    BOTONES:
                    1. "A帽adir al Presupuesto" (btn-primary) - Acci贸n principal
                    2. "A帽adir Secci贸n" (btn-secondary) - Acci贸n auxiliar
                    3. "A帽adir Otro Cap铆tulo" (btn-secondary) - Acci贸n de continuidad
                    4. "Cancelar" (btn-secondary) - Acci贸n de salida
                    
                    CARACTERSTICAS:
                    - Bot贸n principal destacado visualmente
                    - Botones secundarios con funcionalidades espec铆ficas
                    - Bot贸n de cancelar con comportamiento especial
                -->
                <footer>
                    <!-- Acci贸n principal: a帽adir cap铆tulo al presupuesto -->
                    <button name="add_to_order" string="A帽adir al Presupuesto" type="object" class="btn-primary"/>
                    <!-- Acci贸n auxiliar: a帽adir nueva secci贸n -->
                    <button name="add_seccion" string="A帽adir Secci贸n" type="object" class="btn-secondary"/>
                    <!-- Acci贸n de continuidad: a帽adir otro cap铆tulo -->
                    <button name="add_another_chapter" string="A帽adir Otro Cap铆tulo" type="object" class="btn-secondary"/>
                    <!-- Acci贸n de salida: cancelar wizard -->
                    <button string="Cancelar" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- 
        ACCIN DEL WIZARD
        ================
        
        PROPSITO:
        - Define la acci贸n para abrir el wizard de gesti贸n de cap铆tulos
        - Configuraci贸n para ventana modal (target="new")
        - Integraci贸n con el sistema de acciones de Odoo
        
        CARACTERSTICAS:
        - Nombre descriptivo para men煤s y referencias
        - Modelo objetivo: capitulo.wizard
        - Modo de vista: formulario 煤nicamente
        - Target: nueva ventana (modal)
        
        USO:
        - Se invoca desde botones en vistas de pedidos de venta
        - Puede ser llamada desde acciones de servidor
        - Integrable en men煤s si se requiere acceso directo
    -->
    <record id="capitulo_wizard_action" model="ir.actions.act_window">
        <field name="name">Gestionar Cap铆tulos del Presupuesto</field>
        <field name="res_model">capitulo.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>
</odoo>